{
  "id": "732",
  "name": "Incorrect Permission Assignment for Critical Resource",
  "abstraction": "Class",
  "structure": "Simple",
  "status": "Draft",
  "description": "The product specifies permissions for a security-critical resource in a way that allows that resource to be read or modified by unintended actors.",
  "extended_description": "When a resource is given a permission setting that provides access to a wider range of actors than required, it could lead to the exposure of sensitive information, or the modification of that resource by unintended parties. This is especially dangerous when the resource is related to program configuration, execution, or sensitive user data. For example, consider a misconfigured storage account for the cloud that can be read or written by a public or anonymous user.",
  "related_weaknesses": [
    {
      "nature": "ChildOf",
      "cweid": "285",
      "view_id": "1000",
      "ordinal": "Primary"
    },
    {
      "nature": "ChildOf",
      "cweid": "668",
      "view_id": "1000"
    }
  ],
  "applicable_platforms": {
    "language": [
      {
        "class": "Not Language-Specific",
        "prevalence": "Undetermined"
      }
    ],
    "technology": [
      {
        "class": "Not Technology-Specific",
        "prevalence": "Undetermined"
      },
      {
        "class": "Cloud Computing",
        "prevalence": "Often"
      }
    ]
  },
  "modes_of_introduction": [
    {
      "phase": "Architecture and Design"
    },
    {
      "phase": "Implementation",
      "note": [
        "\n                  <xhtml:p>REALIZATION: This weakness is caused during implementation of an architectural security tactic.</xhtml:p>\n                  <xhtml:p>The developer might make certain assumptions about the environment in which the product operates - e.g., that the software is running on a single-user system, or the software is only accessible to trusted administrators. When the software is running in a different environment, the permissions become a problem.</xhtml:p>\n               "
      ]
    },
    {
      "phase": "Installation",
      "note": [
        "The developer may set loose permissions in order to minimize problems when the user first runs the program, then create documentation stating that permissions should be tightened. Since system administrators and users do not always read the documentation, this can result in insecure permissions being left unchanged."
      ]
    },
    {
      "phase": "Operation"
    }
  ],
  "likelihood_of_exploit": "High",
  "common_consequences": [
    {
      "scope": [
        "Confidentiality"
      ],
      "impact": [
        "Read Application Data",
        "Read Files or Directories"
      ],
      "note": "An attacker may be able to read sensitive information from the associated resource, such as credentials or configuration information stored in a file."
    },
    {
      "scope": [
        "Access Control"
      ],
      "impact": [
        "Gain Privileges or Assume Identity"
      ],
      "note": "An attacker may be able to modify critical properties of the associated resource to gain privileges, such as replacing a world-writable executable with a Trojan horse."
    },
    {
      "scope": [
        "Integrity",
        "Other"
      ],
      "impact": [
        "Modify Application Data",
        "Other"
      ],
      "note": "An attacker may be able to destroy or corrupt critical data in the associated resource, such as deletion of records from a database."
    }
  ],
  "potential_mitigations": [
    {
      "phase": [
        "Implementation"
      ],
      "description": [
        "When using a critical resource such as a configuration file, check to see if the resource has insecure permissions (such as being modifiable by any regular user) [REF-62], and generate an error or even exit the software if there is a possibility that the resource could have been modified by an unauthorized party."
      ]
    },
    {
      "phase": [
        "Architecture and Design"
      ],
      "description": [
        "Divide the software into anonymous, normal, privileged, and administrative areas. Reduce the attack surface by carefully defining distinct user groups, privileges, and/or roles. Map these against data, functionality, and the related resources. Then set the permissions accordingly. This will allow you to maintain more fine-grained control over your resources. [REF-207]"
      ],
      "effectiveness": "Moderate",
      "effectiveness_notes": "This can be an effective strategy. However, in practice, it may be difficult or time consuming to define these areas when there are many different resources or user types, or if the applications features change rapidly."
    },
    {
      "mitigation_id": "MIT-22",
      "phase": [
        "Architecture and Design",
        "Operation"
      ],
      "description": [
        "\n                  <xhtml:p>Run the code in a \"jail\" or similar sandbox environment that enforces strict boundaries between the process and the operating system. This may effectively restrict which files can be accessed in a particular directory or which commands can be executed by the software.</xhtml:p>\n                  <xhtml:p>OS-level examples include the Unix chroot jail, AppArmor, and SELinux. In general, managed code may provide some protection. For example, java.io.FilePermission in the Java SecurityManager allows the software to specify restrictions on file operations.</xhtml:p>\n                  <xhtml:p>This may not be a feasible solution, and it only limits the impact to the operating system; the rest of the application may still be subject to compromise.</xhtml:p>\n                  <xhtml:p>Be careful to avoid CWE-243 and other weaknesses related to jails.</xhtml:p>\n               "
      ],
      "effectiveness": "Limited",
      "effectiveness_notes": "The effectiveness of this mitigation depends on the prevention capabilities of the specific sandbox or jail being used and might only help to reduce the scope of an attack, such as restricting the attacker to certain system calls or limiting the portion of the file system that can be accessed.",
      "strategy": "Sandbox or Jail"
    },
    {
      "phase": [
        "Implementation",
        "Installation"
      ],
      "description": [
        "During program startup, explicitly set the default permissions or umask to the most restrictive setting possible. Also set the appropriate permissions during program installation. This will prevent you from inheriting insecure permissions from any user who installs or runs the program."
      ],
      "effectiveness": "High"
    },
    {
      "phase": [
        "System Configuration"
      ],
      "description": [
        "For all configuration files, executables, and libraries, make sure that they are only readable and writable by the software's administrator."
      ],
      "effectiveness": "High"
    },
    {
      "phase": [
        "Documentation"
      ],
      "description": [
        "Do not suggest insecure configuration changes in documentation, especially if those configurations can extend to resources and other programs that are outside the scope of the application."
      ]
    },
    {
      "phase": [
        "Installation"
      ],
      "description": [
        "Do not assume that a system administrator will manually change the configuration to the settings that are recommended in the software's manual."
      ]
    },
    {
      "mitigation_id": "MIT-37",
      "phase": [
        "Operation",
        "System Configuration"
      ],
      "description": [
        "Ensure that the software runs properly under the United States Government Configuration Baseline (USGCB) [REF-199] or an equivalent hardening configuration guide, which many organizations use to limit the attack surface and potential risk of deployed software."
      ],
      "strategy": "Environment Hardening"
    },
    {
      "phase": [
        "Implementation",
        "System Configuration",
        "Operation"
      ],
      "description": [
        "When storing data in the cloud (e.g., S3 buckets, Azure blobs, Google Cloud Storage, etc.), use the provider's controls to disable public access."
      ]
    }
  ],
  "demonstrative_examples": [
    {
      "text": "\n               <Intro_Text>The following code sets the umask of the process to 0 before creating a file and writing \"Hello world\" into the file.</Intro_Text>\n               <Example_Code Nature=\"Bad\" Language=\"C\">\n                  <xhtml:div>#define OUTFILE \"hello.out\"<xhtml:br/>\n                     <xhtml:br/>umask(0);<xhtml:br/>FILE *out;<xhtml:br/>\n                     <xhtml:i>/* Ignore link following (CWE-59) for brevity */</xhtml:i>\n                     <xhtml:br/>\n                     <xhtml:br/>out = fopen(OUTFILE, \"w\");<xhtml:br/>if (out) {<xhtml:div style=\"margin-left:1em;\">fprintf(out, \"hello world!\\n\");<xhtml:br/>fclose(out);</xhtml:div>}</xhtml:div>\n               </Example_Code>\n               <Body_Text>After running this program on a UNIX system, running the \"ls -l\" command might return the following output:</Body_Text>\n               <Example_Code Nature=\"Result\">\n                  <xhtml:div>-rw-rw-rw- 1 username 13 Nov 24 17:58 hello.out</xhtml:div>\n               </Example_Code>\n               <Body_Text>The \"rw-rw-rw-\" string indicates that the owner, group, and world (all users) can read the file and write to it.</Body_Text>\n            "
    },
    {
      "text": "\n               <Intro_Text>This code creates a home directory for a new user, and makes that user the owner of the directory. If the new directory cannot be owned by the user, the directory is deleted.</Intro_Text>\n               <Example_Code Nature=\"Bad\" Language=\"PHP\">\n                  <xhtml:div>function createUserDir($username){<xhtml:div style=\"margin-left:1em;\">$path = '/home/'.$username;<xhtml:br/>if(!mkdir($path)){<xhtml:div style=\"margin-left:1em;\">return false;</xhtml:div>}<xhtml:br/>if(!chown($path,$username)){<xhtml:div style=\"margin-left:1em;\">rmdir($path);<xhtml:br/>return false;</xhtml:div>}<xhtml:br/>return true;</xhtml:div>}</xhtml:div>\n               </Example_Code>\n               <Body_Text>Because the optional \"mode\" argument is omitted from the call to mkdir(), the directory is created with the default permissions 0777. Simply setting the new user as the owner of the directory does not explicitly change the permissions of the directory, leaving it with the default. This default allows any user to read and write to the directory, allowing an attack on the user's files. The code also fails to change the owner group of the directory, which may result in access by unexpected groups.</Body_Text>\n               <Body_Text>This code may also be vulnerable to Path Traversal (CWE-22) attacks if an attacker supplies a non alphanumeric username.</Body_Text>\n            "
    },
    {
      "text": "\n               <Intro_Text>The following code snippet might be used as a monitor to periodically record whether a web site is alive. To ensure that the file can always be modified, the code uses chmod() to make the file world-writable.</Intro_Text>\n               <Example_Code Nature=\"Bad\" Language=\"Perl\">\n                  <xhtml:div>$fileName = \"secretFile.out\";<xhtml:br/>\n                     <xhtml:br/>if (-e $fileName) {<xhtml:div style=\"margin-left:1em;\">chmod 0777, $fileName;</xhtml:div>}<xhtml:br/>\n                     <xhtml:br/>my $outFH;<xhtml:br/>if (! open($outFH, \"&gt;&gt;$fileName\")) {<xhtml:div style=\"margin-left:1em;\">ExitError(\"Couldn't append to $fileName: $!\");</xhtml:div>}<xhtml:br/>my $dateString = FormatCurrentTime();<xhtml:br/>my $status = IsHostAlive(\"cwe.mitre.org\");<xhtml:br/>print $outFH \"$dateString cwe status: $status!\\n\";<xhtml:br/>close($outFH);</xhtml:div>\n               </Example_Code>\n               <Body_Text>The first time the program runs, it might create a new file that inherits the permissions from its environment. A file listing might look like:</Body_Text>\n               <Example_Code Nature=\"Result\">\n                  <xhtml:div>-rw-r--r-- 1 username 13 Nov 24 17:58 secretFile.out</xhtml:div>\n               </Example_Code>\n               <Body_Text>This listing might occur when the user has a default umask of 022, which is a common setting. Depending on the nature of the file, the user might not have intended to make it readable by everyone on the system.</Body_Text>\n               <Body_Text>The next time the program runs, however - and all subsequent executions - the chmod will set the file's permissions so that the owner, group, and world (all users) can read the file and write to it:</Body_Text>\n               <Example_Code Nature=\"Result\">\n                  <xhtml:div>-rw-rw-rw- 1 username 13 Nov 24 17:58 secretFile.out</xhtml:div>\n               </Example_Code>\n               <Body_Text>Perhaps the programmer tried to do this because a different process uses different permissions that might prevent the file from being updated.</Body_Text>\n            "
    },
    {
      "text": "\n               <Intro_Text>This program creates and reads from an admin file to determine privilege information.</Intro_Text>\n               <Body_Text>If the admin file doesn't exist, the program will create one. In order to create the file, the program must have write privileges to write to the file. After the file is created, the permissions need to be changed to read only.</Body_Text>\n               <Example_Code Nature=\"Bad\" Language=\"Go\">\n                  <xhtml:div>\n                  const adminFile = \"/etc/admin-users\"<xhtml:br/>\n                  func createAdminFileIfNotExists() error {\n                     <xhtml:div style=\"margin-left:1em;\">\n                        file, err := os.Create(adminFile)<xhtml:br/>\n                        if err != nil {<xhtml:br/>\n                        <xhtml:div style=\"margin-left:1em;\">\n                           return err\n                        </xhtml:div>\n                        }<xhtml:br/>\n                        return nil</xhtml:div>\n                  }</xhtml:div>\n                  <xhtml:br/>\n                  <xhtml:div>\n                  func changeModeOfAdminFile() error {\n                     <xhtml:div style=\"margin-left:1em;\">\n                        fileMode := os.FileMode(0440)<xhtml:br/>\n                        if err := os.Chmod(adminFile, fileMode); err != nil {<xhtml:br/>\n                        <xhtml:div style=\"margin-left:1em;\">\n                           return err\n                        </xhtml:div>\n                        }<xhtml:br/>\n                        return nil</xhtml:div>\n                  }</xhtml:div>\n               </Example_Code>\n               <Body_Text>os.Create will create a file with 0666 permissions before umask if the specified file does not exist. A typical umask of 0022 would result in the file having 0644 permissions. That is, the file would have world-writable and world-readable permissions.</Body_Text>\n               <Body_Text>In this scenario, it is advised to use the more customizable method of os.OpenFile with the os.O_WRONLY and os.O_CREATE flags specifying 0640 permissions to create the admin file.</Body_Text>\n               <Body_Text>This is because on a typical system where the umask is 0022, the perm 0640 applied in os.OpenFile will result in a file of 0620 where only the owner and group can write.</Body_Text>\n            "
    },
    {
      "text": "\n               <Intro_Text>The following command recursively sets world-readable permissions for a directory and all of its children:</Intro_Text>\n               <Example_Code Nature=\"Bad\" Language=\"Shell\">\n                  <xhtml:div>chmod -R ugo+r DIRNAME</xhtml:div>\n               </Example_Code>\n               <Body_Text>If this command is run from a program, the person calling the program might not expect that all the files under the directory will be world-readable. If the directory is expected to contain private data, this could become a security problem.</Body_Text>\n            "
    },
    {
      "demonstrative_example_id": "DX-160",
      "text": "\n\t      <Intro_Text>The following Azure command updates the settings for a storage account:</Intro_Text>\n\t      <Example_Code Nature=\"Bad\" Language=\"Shell\">\n\t\t<xhtml:div>az storage account update --name &lt;storage-account&gt; --resource-group &lt;resource-group&gt; --allow-blob-public-access true</xhtml:div>\n\t      </Example_Code>\n\t      <Body_Text>However, \"Allow Blob Public Access\" is set to true, meaning that anonymous/public users can access blobs.</Body_Text>\n\t      <Body_Text>The command could be modified to disable \"Allow Blob Public Access\" by setting it to false.</Body_Text>\n\t      <Example_Code Nature=\"Good\" Language=\"Shell\">\n\t\t<xhtml:div>az storage account update --name &lt;storage-account&gt; --resource-group &lt;resource-group&gt; --allow-blob-public-access false</xhtml:div>\n\t      </Example_Code>\n\t    "
    },
    {
      "demonstrative_example_id": "DX-161",
      "text": "\n\t      <Intro_Text>The following Google Cloud Storage command gets the settings for a storage account named 'BUCKET_NAME':</Intro_Text>\n\t      <Example_Code Nature=\"Informative\" Language=\"Shell\">\n\t\t<xhtml:div>\n\t\t  gsutil iam get gs://BUCKET_NAME<xhtml:br/>\n\t\t</xhtml:div>\n\t      </Example_Code>\n\t      <Body_Text>Suppose the command returns the following result:</Body_Text>\n\t      <Example_Code Nature=\"Bad\" Language=\"JSON\">\n\t\t{<xhtml:br/>\n\t\t<xhtml:div style=\"margin-left:1em;\">\n\t\t  \"bindings\":[{<xhtml:br/>\n\t\t  <xhtml:div style=\"margin-left:1em;\">\n\t\t    \"members\":[<xhtml:br/>\n\t\t    <xhtml:div style=\"margin-left:1em;\">\n\t\t      \"projectEditor: PROJECT-ID\",<xhtml:br/>\n\t\t      \"projectOwner: PROJECT-ID\"\n\t\t    </xhtml:div>\n\t\t    ],<xhtml:br/>\n\t\t    \"role\":\"roles/storage.legacyBucketOwner\"<xhtml:br/>\n\t\t  </xhtml:div>\n\t\t  },<xhtml:br/>\n\t\t  {<xhtml:br/>\n\t\t  <xhtml:div style=\"margin-left:1em;\">\n\t\t    \"members\":[\n\t\t    <xhtml:div style=\"margin-left:1em;\">\n\t\t      \"allUsers\",<xhtml:br/>\n\t\t      \"projectViewer: PROJECT-ID\"<xhtml:br/>\n\t\t      ],<xhtml:br/>\n\t\t      \"role\":\"roles/storage.legacyBucketReader\"<xhtml:br/>\n\t\t    </xhtml:div>\n\t\t    }<xhtml:br/>\n\t\t  </xhtml:div>\n\t\t  ]<xhtml:br/>\n\t\t</xhtml:div>\n\t\t}<xhtml:br/>\n\t      </Example_Code>\n\t      <Body_Text>This result includes the \"allUsers\" or IAM role added as members, causing this policy configuration to allow public access to cloud storage resources. There would be a similar concern if \"allAuthenticatedUsers\" was present.</Body_Text>\n\t      <Body_Text>The command could be modified to remove \"allUsers\" and/or \"allAuthenticatedUsers\" as follows:</Body_Text>\n\t      <Example_Code Nature=\"Good\" Language=\"Shell\">\n\t\tgsutil iam ch -d allUsers gs://BUCKET_NAME<xhtml:br/>\n\t\tgsutil iam ch -d allAuthenticatedUsers gs://BUCKET_NAME<xhtml:br/>\n\t      </Example_Code>\n\t    "
    }
  ],
  "observed_examples": [
    {
      "reference": "CVE-2022-29527",
      "description": "Go application for cloud management creates a world-writable sudoers file that allows local attackers to inject sudo rules and escalate privileges to root by winning a race condition.",
      "link": "https://www.cve.org/CVERecord?id=CVE-2022-29527"
    },
    {
      "reference": "CVE-2009-3482",
      "description": "Anti-virus product sets insecure \"Everyone: Full Control\" permissions for files under the \"Program Files\" folder, allowing attackers to replace executables with Trojan horses.",
      "link": "https://www.cve.org/CVERecord?id=CVE-2009-3482"
    },
    {
      "reference": "CVE-2009-3897",
      "description": "Product creates directories with 0777 permissions at installation, allowing users to gain privileges and access a socket used for authentication.",
      "link": "https://www.cve.org/CVERecord?id=CVE-2009-3897"
    },
    {
      "reference": "CVE-2009-3489",
      "description": "Photo editor installs a service with an insecure security descriptor, allowing users to stop or start the service, or execute commands as SYSTEM.",
      "link": "https://www.cve.org/CVERecord?id=CVE-2009-3489"
    },
    {
      "reference": "CVE-2020-15708",
      "description": "socket created with insecure permissions",
      "link": "https://www.cve.org/CVERecord?id=CVE-2020-15708"
    },
    {
      "reference": "CVE-2009-3289",
      "description": "Library function copies a file to a new target and uses the source file's permissions for the target, which is incorrect when the source file is a symbolic link, which typically has 0777 permissions.",
      "link": "https://www.cve.org/CVERecord?id=CVE-2009-3289"
    },
    {
      "reference": "CVE-2009-0115",
      "description": "Device driver uses world-writable permissions for a socket file, allowing attackers to inject arbitrary commands.",
      "link": "https://www.cve.org/CVERecord?id=CVE-2009-0115"
    },
    {
      "reference": "CVE-2009-1073",
      "description": "LDAP server stores a cleartext password in a world-readable file.",
      "link": "https://www.cve.org/CVERecord?id=CVE-2009-1073"
    },
    {
      "reference": "CVE-2009-0141",
      "description": "Terminal emulator creates TTY devices with world-writable permissions, allowing an attacker to write to the terminals of other users.",
      "link": "https://www.cve.org/CVERecord?id=CVE-2009-0141"
    },
    {
      "reference": "CVE-2008-0662",
      "description": "VPN product stores user credentials in a registry key with \"Everyone: Full Control\" permissions, allowing attackers to steal the credentials.",
      "link": "https://www.cve.org/CVERecord?id=CVE-2008-0662"
    },
    {
      "reference": "CVE-2008-0322",
      "description": "Driver installs its device interface with \"Everyone: Write\" permissions.",
      "link": "https://www.cve.org/CVERecord?id=CVE-2008-0322"
    },
    {
      "reference": "CVE-2009-3939",
      "description": "Driver installs a file with world-writable permissions.",
      "link": "https://www.cve.org/CVERecord?id=CVE-2009-3939"
    },
    {
      "reference": "CVE-2009-3611",
      "description": "Product changes permissions to 0777 before deleting a backup; the permissions stay insecure for subsequent backups.",
      "link": "https://www.cve.org/CVERecord?id=CVE-2009-3611"
    },
    {
      "reference": "CVE-2007-6033",
      "description": "Product creates a share with \"Everyone: Full Control\" permissions, allowing arbitrary program execution.",
      "link": "https://www.cve.org/CVERecord?id=CVE-2007-6033"
    },
    {
      "reference": "CVE-2007-5544",
      "description": "Product uses \"Everyone: Full Control\" permissions for memory-mapped files (shared memory) in inter-process communication, allowing attackers to tamper with a session.",
      "link": "https://www.cve.org/CVERecord?id=CVE-2007-5544"
    },
    {
      "reference": "CVE-2005-4868",
      "description": "Database product uses read/write permissions for everyone for its shared memory, allowing theft of credentials.",
      "link": "https://www.cve.org/CVERecord?id=CVE-2005-4868"
    },
    {
      "reference": "CVE-2004-1714",
      "description": "Security product uses \"Everyone: Full Control\" permissions for its configuration files.",
      "link": "https://www.cve.org/CVERecord?id=CVE-2004-1714"
    },
    {
      "reference": "CVE-2001-0006",
      "description": "\"Everyone: Full Control\" permissions assigned to a mutex allows users to disable network connectivity.",
      "link": "https://www.cve.org/CVERecord?id=CVE-2001-0006"
    },
    {
      "reference": "CVE-2002-0969",
      "description": "Chain: database product contains buffer overflow that is only reachable through a .ini configuration file - which has \"Everyone: Full Control\" permissions.",
      "link": "https://www.cve.org/CVERecord?id=CVE-2002-0969"
    }
  ],
  "references": [
    {
      "section": "Chapter 9, \"File Permissions.\" Page 495",
      "reference_id": "REF-62",
      "author": [
        "Mark Dowd",
        "John McDonald",
        "Justin Schuh"
      ],
      "title": "The Art of Software Security Assessment",
      "publication_year": "2006",
      "publisher": "Addison Wesley",
      "edition": "1st Edition"
    },
    {
      "section": "Chapter 8, \"Access Control.\" Page 194",
      "reference_id": "REF-207",
      "author": [
        "John Viega",
        "Gary McGraw"
      ],
      "title": "Building Secure Software: How to Avoid Security Problems the Right Way",
      "publication_year": "2002",
      "publisher": "Addison-Wesley",
      "edition": "1st Edition"
    },
    {
      "reference_id": "REF-594",
      "author": [
        "Jason Lam"
      ],
      "title": "Top 25 Series - Rank 21 - Incorrect Permission Assignment for Critical Response",
      "url": "http://software-security.sans.org/blog/2010/03/24/top-25-series-rank-21-incorrect-permission-assignment-for-critical-response",
      "publication_year": "2010",
      "publication_month": "--03",
      "publication_day": "---24",
      "publisher": "SANS Software Security Institute"
    },
    {
      "reference_id": "REF-199",
      "author": [
        "NIST"
      ],
      "title": "United States Government Configuration Baseline (USGCB)",
      "url": "https://csrc.nist.gov/Projects/United-States-Government-Configuration-Baseline",
      "url_date": "2023-03-28"
    },
    {
      "section": "Details of Problematic Mappings",
      "reference_id": "REF-1287",
      "author": [
        "MITRE"
      ],
      "title": "Supplemental Details - 2022 CWE Top 25",
      "url": "https://cwe.mitre.org/top25/archive/2022/2022_cwe_top25_supplemental.html#problematicMappingDetails",
      "publication_year": "2022",
      "publication_month": "--06",
      "publication_day": "---28"
    },
    {
      "section": "Section 3.7",
      "reference_id": "REF-1307",
      "author": [
        "Center for Internet Security"
      ],
      "title": "CIS Microsoft Azure Foundations Benchmark version 1.5.0",
      "url": "https://www.cisecurity.org/benchmark/azure",
      "publication_year": "2022",
      "publication_month": "--08",
      "publication_day": "---16",
      "url_date": "2023-01-19"
    },
    {
      "section": "Section 5.1",
      "reference_id": "REF-1327",
      "author": [
        "Center for Internet Security"
      ],
      "title": "CIS Google Cloud Computing Platform Benchmark version 1.3.0",
      "url": "https://www.cisecurity.org/benchmark/google_cloud_computing_platform",
      "publication_year": "2022",
      "publication_month": "--03",
      "publication_day": "---31",
      "url_date": "2023-04-24"
    }
  ],
  "content_history": {
    "submission": {
      "submission_name": "CWE Content Team",
      "submission_organization": "MITRE",
      "submission_date": "2008-09-08",
      "submission_comment": "new weakness-focused entry for Research view."
    },
    "modification": [
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-01-12",
        "modification_comment": "updated Description, Likelihood_of_Exploit, Name, Potential_Mitigations, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-03-10",
        "modification_comment": "updated Potential_Mitigations, Related_Attack_Patterns"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-05-27",
        "modification_comment": "updated Name"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2009-12-28",
        "modification_comment": "updated Applicable_Platforms, Common_Consequences, Demonstrative_Examples, Detection_Factors, Modes_of_Introduction, Observed_Examples, Potential_Mitigations, References"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2010-02-16",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2010-04-05",
        "modification_comment": "updated Potential_Mitigations, Related_Attack_Patterns"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2010-06-21",
        "modification_comment": "updated Common_Consequences, Detection_Factors, Potential_Mitigations, References, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2010-09-27",
        "modification_comment": "updated Potential_Mitigations, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2010-12-13",
        "modification_comment": "updated Potential_Mitigations"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-03-29",
        "modification_comment": "updated Demonstrative_Examples, Description, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-06-01",
        "modification_comment": "updated Common_Consequences, Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-06-27",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2011-09-13",
        "modification_comment": "updated Potential_Mitigations, References, Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-05-11",
        "modification_comment": "updated References, Related_Attack_Patterns, Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2012-10-30",
        "modification_comment": "updated Potential_Mitigations"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2013-07-17",
        "modification_comment": "updated References"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2014-07-30",
        "modification_comment": "updated Detection_Factors, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2017-01-19",
        "modification_comment": "updated Related_Attack_Patterns, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2017-11-08",
        "modification_comment": "updated Likelihood_of_Exploit, Modes_of_Introduction, References, Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2019-01-03",
        "modification_comment": "updated Related_Attack_Patterns, Relationships, Taxonomy_Mappings"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2019-06-20",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2019-09-19",
        "modification_comment": "updated Maintenance_Notes, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-02-24",
        "modification_comment": "updated Applicable_Platforms, Description, Detection_Factors, Modes_of_Introduction, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-08-20",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2020-12-10",
        "modification_comment": "updated Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2021-07-20",
        "modification_comment": "updated Observed_Examples, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2022-10-13",
        "modification_comment": "updated Demonstrative_Examples, Observed_Examples, References"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2023-01-31",
        "modification_comment": "updated Applicable_Platforms, Description, References"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2023-04-27",
        "modification_comment": "updated Demonstrative_Examples, Description, Potential_Mitigations, References, Relationships"
      },
      {
        "modification_name": "CWE Content Team",
        "modification_organization": "MITRE",
        "modification_date": "2023-06-29",
        "modification_comment": "updated Mapping_Notes, Relationships"
      }
    ],
    "previous_entry_name": [
      {
        "text": "Insecure Permission Assignment for Resource",
        "date": "2009-01-12"
      },
      {
        "text": "Insecure Permission Assignment for Critical Resource",
        "date": "2009-05-27"
      }
    ]
  },
  "detection_methods": [
    {
      "method": "Automated Static Analysis",
      "description": "\n                  <xhtml:p>Automated static analysis may be effective in detecting permission problems for system resources such as files, directories, shared memory, device interfaces, etc. Automated techniques may be able to detect the use of library functions that modify permissions, then analyze function calls for arguments that contain potentially insecure values.</xhtml:p>\n                  <xhtml:p>However, since the software's intended security policy might allow loose permissions for certain operations (such as publishing a file on a web server), automated static analysis may produce some false positives - i.e., warnings that do not have any security consequences or require any code changes.</xhtml:p>\n                  <xhtml:p>When custom permissions models are used - such as defining who can read messages in a particular forum in a bulletin board system - these can be difficult to detect using automated static analysis. It may be possible to define custom signatures that identify any custom functions that implement the permission checks and assignments.</xhtml:p>\n               "
    },
    {
      "method": "Automated Dynamic Analysis",
      "description": "\n                  <xhtml:p>Automated dynamic analysis may be effective in detecting permission problems for system resources such as files, directories, shared memory, device interfaces, etc.</xhtml:p>\n                  <xhtml:p>However, since the software's intended security policy might allow loose permissions for certain operations (such as publishing a file on a web server), automated dynamic analysis may produce some false positives - i.e., warnings that do not have any security consequences or require any code changes.</xhtml:p>\n                  <xhtml:p>When custom permissions models are used - such as defining who can read messages in a particular forum in a bulletin board system - these can be difficult to detect using automated dynamic analysis. It may be possible to define custom signatures that identify any custom functions that implement the permission checks and assignments.</xhtml:p>\n               "
    },
    {
      "detection_method_id": "DM-7",
      "method": "Manual Analysis",
      "description": "This weakness can be detected using tools and techniques that require manual (human) analysis, such as penetration testing, threat modeling, and interactive tools that allow the tester to record and modify an active session.",
      "effectiveness_notes": "These may be more effective than strictly automated techniques. This is especially the case with weaknesses that are related to design and business rules."
    },
    {
      "method": "Manual Static Analysis",
      "description": "Manual static analysis may be effective in detecting the use of custom permissions models and functions. The code could then be examined to identifying usage of the related functions. Then the human analyst could evaluate permission assignments in the context of the intended security model of the software."
    },
    {
      "method": "Manual Dynamic Analysis",
      "description": "Manual dynamic analysis may be effective in detecting the use of custom permissions models and functions. The program could then be executed with a focus on exercising code paths that are related to the custom permissions. Then the human analyst could evaluate permission assignments in the context of the intended security model of the software."
    },
    {
      "method": "Fuzzing",
      "description": "Fuzzing is not effective in detecting this weakness."
    },
    {
      "detection_method_id": "DM-11.1",
      "method": "Black Box",
      "description": "\n                  <xhtml:p>Use monitoring tools that examine the software's process as it interacts with the operating system and the network. This technique is useful in cases when source code is unavailable, if the software was not developed by you, or if you want to verify that the build phase did not introduce any new weaknesses. Examples include debuggers that directly attach to the running process; system-call tracing utilities such as truss (Solaris) and strace (Linux); system activity monitors such as FileMon, RegMon, Process Monitor, and other Sysinternals utilities (Windows); and sniffers and protocol analyzers that monitor network traffic.</xhtml:p>\n                  <xhtml:p>Attach the monitor to the process and watch for library functions or system calls on OS resources such as files, directories, and shared memory. Examine the arguments to these calls to infer which permissions are being used.</xhtml:p>\n               ",
      "effectiveness_notes": "Note that this technique is only useful for permissions issues related to system resources. It is not likely to detect application-level business rules that are related to permissions, such as if a user of a blog system marks a post as \"private,\" but the blog system inadvertently marks it as \"public.\""
    },
    {
      "method": "Automated Static Analysis - Binary or Bytecode",
      "description": "\n                  <xhtml:p>According to SOAR, the following detection techniques may be useful:</xhtml:p>\n                  <xhtml:div style=\"margin-left:1em;\">\n                     <xhtml:div>Cost effective for partial coverage:</xhtml:div>\n                        <xhtml:ul>\n                           <xhtml:li>Inter-application Flow Analysis</xhtml:li>\n                        </xhtml:ul>\n                  </xhtml:div>\n               ",
      "effectiveness": "SOAR Partial"
    },
    {
      "method": "Manual Static Analysis - Binary or Bytecode",
      "description": "\n                  <xhtml:p>According to SOAR, the following detection techniques may be useful:</xhtml:p>\n                  <xhtml:div style=\"margin-left:1em;\">\n                     <xhtml:div>Cost effective for partial coverage:</xhtml:div>\n                        <xhtml:ul>\n                           <xhtml:li>Binary / Bytecode disassembler - then use manual analysis for vulnerabilities &amp; anomalies</xhtml:li>\n                        </xhtml:ul>\n                  </xhtml:div>\n               ",
      "effectiveness": "SOAR Partial"
    },
    {
      "method": "Dynamic Analysis with Automated Results Interpretation",
      "description": "\n                  <xhtml:p>According to SOAR, the following detection techniques may be useful:</xhtml:p>\n                  <xhtml:div style=\"margin-left:1em;\">\n                     <xhtml:div>Cost effective for partial coverage:</xhtml:div>\n                        <xhtml:ul>\n                           <xhtml:li>Host-based Vulnerability Scanners - Examine configuration for flaws, verifying that audit mechanisms work, ensure host configuration meets certain predefined criteria</xhtml:li>\n                           <xhtml:li>Web Application Scanner</xhtml:li>\n                           <xhtml:li>Web Services Scanner</xhtml:li>\n                           <xhtml:li>Database Scanners</xhtml:li>\n                        </xhtml:ul>\n                  </xhtml:div>\n               ",
      "effectiveness": "SOAR Partial"
    },
    {
      "method": "Dynamic Analysis with Manual Results Interpretation",
      "description": "\n                  <xhtml:p>According to SOAR, the following detection techniques may be useful:</xhtml:p>\n                  <xhtml:div style=\"margin-left:1em;\">\n                     <xhtml:div>Highly cost effective:</xhtml:div>\n                        <xhtml:ul>\n                           <xhtml:li>Host Application Interface Scanner</xhtml:li>\n                        </xhtml:ul>\n                     <xhtml:div>Cost effective for partial coverage:</xhtml:div>\n                        <xhtml:ul>\n                           <xhtml:li>Fuzz Tester</xhtml:li>\n                           <xhtml:li>Framework-based Fuzzer</xhtml:li>\n                           <xhtml:li>Automated Monitored Execution</xhtml:li>\n                           <xhtml:li>Forced Path Execution</xhtml:li>\n                        </xhtml:ul>\n                  </xhtml:div>\n               ",
      "effectiveness": "High"
    },
    {
      "method": "Manual Static Analysis - Source Code",
      "description": "\n                  <xhtml:p>According to SOAR, the following detection techniques may be useful:</xhtml:p>\n                  <xhtml:div style=\"margin-left:1em;\">\n                     <xhtml:div>Highly cost effective:</xhtml:div>\n                        <xhtml:ul>\n                           <xhtml:li>Manual Source Code Review (not inspections)</xhtml:li>\n                        </xhtml:ul>\n                     <xhtml:div>Cost effective for partial coverage:</xhtml:div>\n                        <xhtml:ul>\n                           <xhtml:li>Focused Manual Spotcheck - Focused manual analysis of source</xhtml:li>\n                        </xhtml:ul>\n                  </xhtml:div>\n               ",
      "effectiveness": "High"
    },
    {
      "method": "Automated Static Analysis - Source Code",
      "description": "\n                  <xhtml:p>According to SOAR, the following detection techniques may be useful:</xhtml:p>\n                  <xhtml:div style=\"margin-left:1em;\">\n                     <xhtml:div>Cost effective for partial coverage:</xhtml:div>\n                        <xhtml:ul>\n                           <xhtml:li>Context-configured Source Code Weakness Analyzer</xhtml:li>\n                        </xhtml:ul>\n                  </xhtml:div>\n               ",
      "effectiveness": "SOAR Partial"
    },
    {
      "method": "Automated Static Analysis",
      "description": "\n                  <xhtml:p>According to SOAR, the following detection techniques may be useful:</xhtml:p>\n                  <xhtml:div style=\"margin-left:1em;\">\n                     <xhtml:div>Cost effective for partial coverage:</xhtml:div>\n                        <xhtml:ul>\n                           <xhtml:li>Configuration Checker</xhtml:li>\n                        </xhtml:ul>\n                  </xhtml:div>\n               ",
      "effectiveness": "SOAR Partial"
    },
    {
      "method": "Architecture or Design Review",
      "description": "\n                  <xhtml:p>According to SOAR, the following detection techniques may be useful:</xhtml:p>\n                  <xhtml:div style=\"margin-left:1em;\">\n                     <xhtml:div>Highly cost effective:</xhtml:div>\n                        <xhtml:ul>\n                           <xhtml:li>Formal Methods / Correct-By-Construction</xhtml:li>\n                        </xhtml:ul>\n                     <xhtml:div>Cost effective for partial coverage:</xhtml:div>\n                        <xhtml:ul>\n                           <xhtml:li>Inspection (IEEE 1028 standard) (can apply to requirements, design, source code, etc.)</xhtml:li>\n                        </xhtml:ul>\n                  </xhtml:div>\n               ",
      "effectiveness": "High"
    }
  ],
  "taxonomy_mappings": [
    {
      "taxonomy_name": "The CERT Oracle Secure Coding Standard for Java (2011)",
      "entry_name": "Create files with appropriate access permission",
      "entry_id": "FIO03-J"
    },
    {
      "taxonomy_name": "The CERT Oracle Secure Coding Standard for Java (2011)",
      "entry_name": "Do not allow tainted variables in privileged blocks",
      "entry_id": "SEC01-J"
    },
    {
      "taxonomy_name": "The CERT Oracle Secure Coding Standard for Java (2011)",
      "entry_name": "Do not grant dangerous combinations of permissions",
      "entry_id": "ENV03-J"
    },
    {
      "taxonomy_name": "CERT C Secure Coding",
      "entry_name": "Create files with appropriate access permissions",
      "entry_id": "FIO06-C"
    }
  ],
  "related_attack_patterns": [
    "1",
    "122",
    "127",
    "17",
    "180",
    "206",
    "234",
    "60",
    "61",
    "62",
    "642"
  ],
  "notes": [
    {
      "type": "Maintenance",
      "text": "The relationships between privileges, permissions, and actors (e.g. users and groups) need further refinement within the Research view. One complication is that these concepts apply to two different pillars, related to control of resources (CWE-664) and protection mechanism failures (CWE-693)."
    }
  ]
}
